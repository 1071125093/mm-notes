"use strict";(self.webpackChunkmm_notes=self.webpackChunkmm_notes||[]).push([[804],{7592:(l,n,e)=>{e.r(n),e.d(n,{data:()=>s});const s={key:"v-4dbb1ce4",path:"/interview/browser/",title:"浏览器知识",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"跨域",slug:"跨域",children:[{level:3,title:"常用的跨域解决方案",slug:"常用的跨域解决方案",children:[]},{level:3,title:"CORS 跨源资源共享",slug:"cors-跨源资源共享",children:[]},{level:3,title:"JSONP",slug:"jsonp",children:[]}]},{level:2,title:"浏览器缓存机制",slug:"浏览器缓存机制",children:[{level:3,title:"强缓存（200 OK）",slug:"强缓存-200-ok",children:[]},{level:3,title:"协商缓存（304 Not Modified）",slug:"协商缓存-304-not-modified",children:[]},{level:3,title:"应用场景",slug:"应用场景",children:[]},{level:3,title:"用户行为对缓存的影响",slug:"用户行为对缓存的影响",children:[]}]}],filePathRelative:"interview/browser/README.md",git:{updatedTime:1655729487e3}}},3655:(l,n,e)=>{e.r(n),e.d(n,{default:()=>bl});var s=e(6252),o=e(809);const _=(0,s._)("h1",{id:"浏览器知识",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#浏览器知识","aria-hidden":"true"},"#"),(0,s.Uk)(" 浏览器知识")],-1),a=(0,s._)("h2",{id:"跨域",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#跨域","aria-hidden":"true"},"#"),(0,s.Uk)(" 跨域")],-1),c={class:"custom-container tip"},r=(0,s._)("p",{class:"custom-container-title"},"跨域的原因 —— 浏览器的同源策略",-1),t={href:"https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy",target:"_blank",rel:"noopener noreferrer"},u=(0,s.Uk)("同源策略"),i=(0,s.Uk)("是浏览器一个重要的安全策略，它用于限制一个 "),D=(0,s._)("code",null,"origin",-1),p=(0,s.Uk)(" 的文档或者它加载的脚本如何能与另一个源的资源进行交互。它能帮助阻隔恶意文档，减少可能被攻击的媒介"),d=(0,s._)("p",null,[(0,s.Uk)("同源的定义是两个 "),(0,s._)("code",null,"URL"),(0,s.Uk)(" 的 "),(0,s._)("strong",null,"协议"),(0,s.Uk)("、"),(0,s._)("strong",null,"域名"),(0,s.Uk)("(子域名 + 主域名)、"),(0,s._)("strong",null,"端口号"),(0,s.Uk)(" 都相同，否则就会出现跨域")],-1),k=(0,s._)("div",{class:"custom-container tip"},[(0,s._)("p",{class:"custom-container-title"},"同源策略的限制范围"),(0,s._)("ol",null,[(0,s._)("li",null,[(0,s.Uk)("限制跨源网络访问: "),(0,s._)("code",null,"AJAX"),(0,s.Uk)(" 请求不能发送")]),(0,s._)("li",null,[(0,s.Uk)("限制跨源脚本 "),(0,s._)("code",null,"API"),(0,s.Uk)(" 访问: "),(0,s._)("code",null,"DOM"),(0,s.Uk)(" 无法获得")]),(0,s._)("li",null,[(0,s.Uk)("限制跨源数据存储访问: "),(0,s._)("code",null,"Cookie"),(0,s.Uk)(),(0,s._)("code",null,"LocalStorage"),(0,s.Uk)(" 和 "),(0,s._)("code",null,"IndexDB"),(0,s.Uk)(" 无法读取")])]),(0,s._)("p",null,"一般常说的跨域指网络跨域")],-1),U=(0,s._)("h3",{id:"常用的跨域解决方案",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#常用的跨域解决方案","aria-hidden":"true"},"#"),(0,s.Uk)(" 常用的跨域解决方案")],-1),y=(0,s._)("div",{class:"custom-container tip"},[(0,s._)("p",{class:"custom-container-title"},"常用的跨域解决方案"),(0,s._)("ol",null,[(0,s._)("li",null,[(0,s._)("strong",null,"CORS")]),(0,s._)("li",null,[(0,s._)("strong",null,"JSONP")]),(0,s._)("li",null,"Nginx 反向代理"),(0,s._)("li",null,"WebSocket"),(0,s._)("li",null,"postMessage"),(0,s._)("li",null,"document.domain")])],-1),C=(0,s._)("h3",{id:"cors-跨源资源共享",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#cors-跨源资源共享","aria-hidden":"true"},"#"),(0,s.Uk)(" CORS 跨源资源共享")],-1),h={href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS",target:"_blank",rel:"noopener noreferrer"},m=(0,s.Uk)("CORS (跨源资源共享)"),b=(0,s.Uk)(" 是 "),g={href:"https://developer.mozilla.org/zh-CN/docs/Glossary/HTTP",target:"_blank",rel:"noopener noreferrer"},E=(0,s.Uk)("HTTP"),f=(0,s.Uk)(" 的一部分，它允许浏览器向跨源服务器发出 "),A=(0,s._)("code",null,"XMLHttpRequest",-1),x=(0,s.Uk)(" 请求，从而解决了 "),O=(0,s._)("code",null,"AJAX",-1),S=(0,s.Uk)(" 只能同源使用的限制。"),v=(0,s._)("blockquote",null,[(0,s._)("p",null,[(0,s._)("code",null,"CORS"),(0,s.Uk)(" 需要浏览器和服务器同时支持，目前所有浏览器均已支持，只需服务器配置即可使用")])],-1),F=(0,s._)("p",null,[(0,s.Uk)("浏览器将 "),(0,s._)("code",null,"CORS"),(0,s.Uk)(" 请求分成两类: "),(0,s._)("strong",null,"简单请求"),(0,s.Uk)("和"),(0,s._)("strong",null,"非简单请求")],-1),T=(0,s._)("h4",{id:"简单请求",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#简单请求","aria-hidden":"true"},"#"),(0,s.Uk)(" 简单请求")],-1),w=(0,s._)("div",{class:"custom-container tip"},[(0,s._)("p",{class:"custom-container-title"},"简单请求必须同时满足以下条件"),(0,s._)("blockquote",null,[(0,s._)("p",null,"日常开发只会关注前两点")]),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Uk)("请求方法是以下三种方法之一 "),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s._)("code",null,"HEAD")]),(0,s._)("li",null,[(0,s._)("code",null,"GET")]),(0,s._)("li",null,[(0,s._)("code",null,"POST")])])]),(0,s._)("li",null,[(0,s.Uk)("只使用了如下的安全首部字段，不得人为设置其他首部字段 "),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s._)("code",null,"Accept")]),(0,s._)("li",null,[(0,s._)("code",null,"Accept-Language")]),(0,s._)("li",null,[(0,s._)("code",null,"Content-Language")]),(0,s._)("li",null,[(0,s._)("code",null,"Content-Type"),(0,s.Uk)(" 仅限以下三种 "),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s._)("code",null,"application/x-www-form-urlencoded")]),(0,s._)("li",null,[(0,s._)("code",null,"multipart/form-data")]),(0,s._)("li",null,[(0,s._)("code",null,"text/plain")])])])])]),(0,s._)("li",null,[(0,s.Uk)("请求中的任意 "),(0,s._)("code",null,"XMLHttpRequestUpload"),(0,s.Uk)(" 对象均没有注册任何事件监听器(使用 "),(0,s._)("code",null,"XMLHttpRequest.upload"),(0,s.Uk)(" 属性访问"),(0,s._)("code",null,"XMLHttpRequestUpload"),(0,s.Uk)(" 对象)")]),(0,s._)("li",null,[(0,s.Uk)("请求中没有使用 "),(0,s._)("code",null,"ReadableStream"),(0,s.Uk)(" 对象")])])],-1),M=(0,s._)("h5",{id:"简单请求基本流程",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#简单请求基本流程","aria-hidden":"true"},"#"),(0,s.Uk)(" 简单请求基本流程")],-1),R=(0,s._)("ol",null,[(0,s._)("li",null,[(0,s.Uk)("浏览器会直接发出 "),(0,s._)("code",null,"CORS"),(0,s.Uk)(" 请求并在请求头信息之中增加一个 "),(0,s._)("code",null,"Origin"),(0,s.Uk)(" 字段(用来说明本次请求来自哪个源(协议 + 域名 + 端口))")]),(0,s._)("li",null,[(0,s.Uk)("服务器判断 "),(0,s._)("code",null,"Origin"),(0,s.Uk)(" 字段决定是否同意这次请求 "),(0,s._)("ol",null,[(0,s._)("li",null,[(0,s.Uk)("通过请求会在响应头增加 "),(0,s._)("code",null,"CORS"),(0,s.Uk)(" 相关的字段(以"),(0,s._)("code",null,"Access-Control-"),(0,s.Uk)("开头)")]),(0,s._)("li",null,[(0,s.Uk)("拒绝请求时不会增加 "),(0,s._)("code",null,"CORS"),(0,s.Uk)(" 相关的字段，浏览器会抛出异常")])])])],-1),P=(0,s._)("div",{class:"custom-container tip"},[(0,s._)("p",{class:"custom-container-title"},"简单请求响应头中的 CORS 字段"),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s._)("code",null,"Access-Control-Allow-Origin"),(0,s.Uk)(": 只能是 "),(0,s._)("code",null,"*"),(0,s.Uk)("(接受任意域名的请求)或者是请求时 "),(0,s._)("code",null,"Origin"),(0,s.Uk)(" 字段的值")]),(0,s._)("li",null,[(0,s._)("code",null,"Access-Control-Allow-Credentials"),(0,s.Uk)("(可选): 是一个布尔值,表示是否允许发送 "),(0,s._)("code",null,"Cookie")]),(0,s._)("li",null,[(0,s._)("code",null,"Access-Control-Expose-Headers"),(0,s.Uk)("(可选): "),(0,s._)("code",null,"CORS"),(0,s.Uk)(" 请求时 "),(0,s._)("code",null,"XMLHttpRequest"),(0,s.Uk)(" 对象的 "),(0,s._)("code",null,"getResponseHeader()"),(0,s.Uk)(" 方法只能拿到 6 个基本字段："),(0,s._)("code",null,"Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma"),(0,s.Uk)("。如果想拿到其他字段就必须在 "),(0,s._)("code",null,"Access-Control-Expose-Headers"),(0,s.Uk)(" 里面指定")])])],-1),L=(0,s._)("div",{class:"custom-container tip"},[(0,s._)("p",{class:"custom-container-title"},"CORS 中的 Cookie 设置"),(0,s._)("p",null,[(0,s._)("code",null,"CORS"),(0,s.Uk)(" 请求默认不发送 "),(0,s._)("code",null,"Cookie"),(0,s.Uk)("，如果需要发送需要满足如下条件")]),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Uk)("服务器必须设置 "),(0,s._)("code",null,"Access-Control-Allow-Credentials: true")]),(0,s._)("li",null,[(0,s._)("code",null,"Access-Control-Allow-Origin"),(0,s.Uk)(" 字段不能为 "),(0,s._)("code",null,"*")]),(0,s._)("li",null,[(0,s._)("code",null,"AJAX"),(0,s.Uk)(" 请求的配置项需设置 "),(0,s._)("code",null,"withCredentials = true")])])],-1),H=(0,s._)("h4",{id:"非简单请求",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#非简单请求","aria-hidden":"true"},"#"),(0,s.Uk)(" 非简单请求")],-1),N=(0,s._)("p",null,[(0,s.Uk)("非简单请求是那种对服务器有特殊要求的请求，如请求方法是 "),(0,s._)("code",null,"PUT"),(0,s.Uk)(" 或 "),(0,s._)("code",null,"DELETE"),(0,s.Uk)("，或者 "),(0,s._)("code",null,"Content-Type"),(0,s.Uk)(" 字段的类型是 "),(0,s._)("code",null,"application/json"),(0,s.Uk)("。"),(0,s._)("br"),(0,s.Uk)(" 非简单请求会在正式通信之前增加一次 "),(0,s._)("code",null,"HTTP"),(0,s.Uk)(" 查询请求，称为"),(0,s._)("strong",null,"预检请求"),(0,s.Uk)("，用于获取服务器是否允许该实际请求，同时避免跨域请求对服务器的用户数据产生预期之外的影响")],-1),j=(0,s._)("div",{class:"custom-container tip"},[(0,s._)("p",{class:"custom-container-title"},"预检请求"),(0,s._)("p",null,[(0,s.Uk)("预检请求用的请求方法是 "),(0,s._)("code",null,"OPTIONS"),(0,s.Uk)(" 表示这个请求是用来询问的")]),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Uk)("在预检请求请求头信息里会包含如下字段 "),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s._)("code",null,"Origin"),(0,s.Uk)(": 表示本次请求来自哪个源")]),(0,s._)("li",null,[(0,s._)("code",null,"Access-Control-Request-Method"),(0,s.Uk)(": 用于列出浏览器的 "),(0,s._)("code",null,"CORS"),(0,s.Uk)(" 请求会用到哪些 "),(0,s._)("code",null,"HTTP"),(0,s.Uk)(" 方法")]),(0,s._)("li",null,[(0,s._)("code",null,"Access-Control-Request-Headers"),(0,s.Uk)("(可选): 指定浏览器 "),(0,s._)("code",null,"CORS"),(0,s.Uk)(" 请求会额外发送的头信息字段")])])]),(0,s._)("li",null,[(0,s.Uk)("服务器通过后会在预检请求响应头中设置如下字段 "),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s._)("code",null,"Access-Control-Allow-Origin")]),(0,s._)("li",null,[(0,s._)("code",null,"Access-Control-Allow-Credentials"),(0,s.Uk)("(可选)")]),(0,s._)("li",null,[(0,s._)("code",null,"Access-Control-Allow-Methods"),(0,s.Uk)(": 表示服务器支持的所有跨域请求的方法(为了避免多次预检请求)")]),(0,s._)("li",null,[(0,s._)("code",null,"Access-Control-Allow-Headers"),(0,s.Uk)(": 表示服务器支持的所有头信息字段，不限于浏览器在预检中请求的字段")]),(0,s._)("li",null,[(0,s._)("code",null,"Access-Control-Max-Age"),(0,s.Uk)("(可选): 用来指定本次预检请求的有效期单位为秒，在有效期内将不发出另一条预检请求")])])])])],-1),J=(0,s._)("p",null,[(0,s.Uk)("一旦服务器通过了预检请求，以后每次浏览器正常的 "),(0,s._)("code",null,"CORS"),(0,s.Uk)(" 请求，就都跟简单请求一样会有一个 "),(0,s._)("code",null,"Origin"),(0,s.Uk)(" 头信息字段。服务器的回应也都会有一个 "),(0,s._)("code",null,"Access-Control-Allow-Origin"),(0,s.Uk)(" 头信息字段")],-1),I=(0,s._)("details",{class:"custom-container details"},[(0,s._)("summary",null,"CORS 请求过程"),(0,s._)("p",null,[(0,s._)("img",{src:o,alt:"CORS 请求过程"})])],-1),W={href:"http://www.ruanyifeng.com/blog/2016/04/cors.html",target:"_blank",rel:"noopener noreferrer"},q=(0,s.Uk)("参考资料 —— 跨域资源共享 CORS 详解"),z=(0,s._)("h3",{id:"jsonp",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#jsonp","aria-hidden":"true"},"#"),(0,s.Uk)(" JSONP")],-1),X=(0,s._)("p",null,[(0,s._)("code",null,"JSONP"),(0,s.Uk)(" 是利用 "),(0,s._)("code",null,"<script>"),(0,s.Uk)(" 标签没有跨域限制的漏洞，当前源可以得到从其他来源动态产生的 "),(0,s._)("code",null,"JSON"),(0,s.Uk)(" 数据")],-1),$=(0,s._)("p",null,[(0,s._)("strong",null,[(0,s._)("code",null,"JSONP"),(0,s.Uk)(" 请求过程流程")])],-1),G=(0,s._)("ol",null,[(0,s._)("li",null,"前端定义一个解析的回调函数"),(0,s._)("li",null,[(0,s.Uk)("创建 "),(0,s._)("code",null,"script"),(0,s.Uk)(" 标签，其 "),(0,s._)("code",null,"src"),(0,s.Uk)(" 指向接口地址并拼接好参数和回调函数名")]),(0,s._)("li",null,[(0,s.Uk)("后端处理数据并将其拼接到前端传入的回调函数中(拼接好的数据必须是一个合法的 "),(0,s._)("code",null,"JavaScript"),(0,s.Uk)(" 脚本 )")]),(0,s._)("li",null,[(0,s.Uk)("浏览器执行后端返回的 "),(0,s._)("code",null,"JavaScript"),(0,s.Uk)(" 脚本代码(调用定义好的回调函数)并删除刚创建的 "),(0,s._)("code",null,"script"),(0,s.Uk)(" 标签")])],-1),B=(0,s._)("details",{class:"custom-container details"},[(0,s._)("summary",null,"JSONP 代码实现"),(0,s._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,s._)("pre",{class:"shiki",style:{"background-color":"#1E1E1E"}},[(0,s._)("code",null,[(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#569CD6"}},"function"),(0,s._)("span",{style:{color:"#D4D4D4"}}," "),(0,s._)("span",{style:{color:"#DCDCAA"}},"normalizeParams"),(0,s._)("span",{style:{color:"#D4D4D4"}},"("),(0,s._)("span",{style:{color:"#9CDCFE"}},"params"),(0,s._)("span",{style:{color:"#D4D4D4"}},") {")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"  "),(0,s._)("span",{style:{color:"#C586C0"}},"if"),(0,s._)("span",{style:{color:"#D4D4D4"}}," (!"),(0,s._)("span",{style:{color:"#9CDCFE"}},"params"),(0,s._)("span",{style:{color:"#D4D4D4"}},") {")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"    "),(0,s._)("span",{style:{color:"#C586C0"}},"return"),(0,s._)("span",{style:{color:"#D4D4D4"}}," "),(0,s._)("span",{style:{color:"#CE9178"}},"''")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"  }")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"  "),(0,s._)("span",{style:{color:"#C586C0"}},"return"),(0,s._)("span",{style:{color:"#D4D4D4"}}," "),(0,s._)("span",{style:{color:"#4EC9B0"}},"Object"),(0,s._)("span",{style:{color:"#D4D4D4"}},"."),(0,s._)("span",{style:{color:"#DCDCAA"}},"keys"),(0,s._)("span",{style:{color:"#D4D4D4"}},"("),(0,s._)("span",{style:{color:"#9CDCFE"}},"params"),(0,s._)("span",{style:{color:"#D4D4D4"}},")")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"    ."),(0,s._)("span",{style:{color:"#DCDCAA"}},"map"),(0,s._)("span",{style:{color:"#D4D4D4"}},"(("),(0,s._)("span",{style:{color:"#9CDCFE"}},"key"),(0,s._)("span",{style:{color:"#D4D4D4"}},") "),(0,s._)("span",{style:{color:"#569CD6"}},"=>"),(0,s._)("span",{style:{color:"#D4D4D4"}}," "),(0,s._)("span",{style:{color:"#CE9178"}},"`"),(0,s._)("span",{style:{color:"#569CD6"}},"${"),(0,s._)("span",{style:{color:"#9CDCFE"}},"key"),(0,s._)("span",{style:{color:"#569CD6"}},"}"),(0,s._)("span",{style:{color:"#CE9178"}},"="),(0,s._)("span",{style:{color:"#569CD6"}},"${"),(0,s._)("span",{style:{color:"#9CDCFE"}},"params"),(0,s._)("span",{style:{color:"#D4D4D4"}},"["),(0,s._)("span",{style:{color:"#9CDCFE"}},"key"),(0,s._)("span",{style:{color:"#D4D4D4"}},"]"),(0,s._)("span",{style:{color:"#569CD6"}},"}"),(0,s._)("span",{style:{color:"#CE9178"}},"`"),(0,s._)("span",{style:{color:"#D4D4D4"}},")")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"    ."),(0,s._)("span",{style:{color:"#DCDCAA"}},"join"),(0,s._)("span",{style:{color:"#D4D4D4"}},"("),(0,s._)("span",{style:{color:"#CE9178"}},"'&'"),(0,s._)("span",{style:{color:"#D4D4D4"}},")")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"}")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"}),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#569CD6"}},"function"),(0,s._)("span",{style:{color:"#D4D4D4"}}," "),(0,s._)("span",{style:{color:"#DCDCAA"}},"jsonp"),(0,s._)("span",{style:{color:"#D4D4D4"}},"("),(0,s._)("span",{style:{color:"#9CDCFE"}},"url"),(0,s._)("span",{style:{color:"#D4D4D4"}},", "),(0,s._)("span",{style:{color:"#9CDCFE"}},"params"),(0,s._)("span",{style:{color:"#D4D4D4"}},") {")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"  "),(0,s._)("span",{style:{color:"#C586C0"}},"return"),(0,s._)("span",{style:{color:"#D4D4D4"}}," "),(0,s._)("span",{style:{color:"#569CD6"}},"new"),(0,s._)("span",{style:{color:"#D4D4D4"}}," "),(0,s._)("span",{style:{color:"#4EC9B0"}},"Promise"),(0,s._)("span",{style:{color:"#D4D4D4"}},"(("),(0,s._)("span",{style:{color:"#9CDCFE"}},"resolve"),(0,s._)("span",{style:{color:"#D4D4D4"}},") "),(0,s._)("span",{style:{color:"#569CD6"}},"=>"),(0,s._)("span",{style:{color:"#D4D4D4"}}," {")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"    "),(0,s._)("span",{style:{color:"#569CD6"}},"const"),(0,s._)("span",{style:{color:"#D4D4D4"}}," "),(0,s._)("span",{style:{color:"#4FC1FF"}},"callback"),(0,s._)("span",{style:{color:"#D4D4D4"}}," = "),(0,s._)("span",{style:{color:"#CE9178"}},"`jsonp_"),(0,s._)("span",{style:{color:"#569CD6"}},"${"),(0,s._)("span",{style:{color:"#4EC9B0"}},"Date"),(0,s._)("span",{style:{color:"#D4D4D4"}},"."),(0,s._)("span",{style:{color:"#DCDCAA"}},"now"),(0,s._)("span",{style:{color:"#D4D4D4"}},"()"),(0,s._)("span",{style:{color:"#569CD6"}},"}"),(0,s._)("span",{style:{color:"#CE9178"}},"`")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"    "),(0,s._)("span",{style:{color:"#9CDCFE"}},"window"),(0,s._)("span",{style:{color:"#D4D4D4"}},"["),(0,s._)("span",{style:{color:"#9CDCFE"}},"callback"),(0,s._)("span",{style:{color:"#D4D4D4"}},"] = "),(0,s._)("span",{style:{color:"#569CD6"}},"function"),(0,s._)("span",{style:{color:"#D4D4D4"}}," ("),(0,s._)("span",{style:{color:"#9CDCFE"}},"data"),(0,s._)("span",{style:{color:"#D4D4D4"}},") {")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"      "),(0,s._)("span",{style:{color:"#DCDCAA"}},"resolve"),(0,s._)("span",{style:{color:"#D4D4D4"}},"("),(0,s._)("span",{style:{color:"#9CDCFE"}},"data"),(0,s._)("span",{style:{color:"#D4D4D4"}},")")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"      "),(0,s._)("span",{style:{color:"#9CDCFE"}},"document"),(0,s._)("span",{style:{color:"#D4D4D4"}},"."),(0,s._)("span",{style:{color:"#9CDCFE"}},"body"),(0,s._)("span",{style:{color:"#D4D4D4"}},"."),(0,s._)("span",{style:{color:"#DCDCAA"}},"removeChild"),(0,s._)("span",{style:{color:"#D4D4D4"}},"("),(0,s._)("span",{style:{color:"#9CDCFE"}},"scriptEle"),(0,s._)("span",{style:{color:"#D4D4D4"}},")")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"    }")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"    "),(0,s._)("span",{style:{color:"#9CDCFE"}},"params"),(0,s._)("span",{style:{color:"#D4D4D4"}},"."),(0,s._)("span",{style:{color:"#9CDCFE"}},"cb"),(0,s._)("span",{style:{color:"#D4D4D4"}}," = "),(0,s._)("span",{style:{color:"#9CDCFE"}},"callback")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"    "),(0,s._)("span",{style:{color:"#569CD6"}},"const"),(0,s._)("span",{style:{color:"#D4D4D4"}}," "),(0,s._)("span",{style:{color:"#4FC1FF"}},"scriptEle"),(0,s._)("span",{style:{color:"#D4D4D4"}}," = "),(0,s._)("span",{style:{color:"#9CDCFE"}},"document"),(0,s._)("span",{style:{color:"#D4D4D4"}},"."),(0,s._)("span",{style:{color:"#DCDCAA"}},"createElement"),(0,s._)("span",{style:{color:"#D4D4D4"}},"("),(0,s._)("span",{style:{color:"#CE9178"}},"'script'"),(0,s._)("span",{style:{color:"#D4D4D4"}},")")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"    "),(0,s._)("span",{style:{color:"#9CDCFE"}},"scriptEle"),(0,s._)("span",{style:{color:"#D4D4D4"}},"."),(0,s._)("span",{style:{color:"#9CDCFE"}},"src"),(0,s._)("span",{style:{color:"#D4D4D4"}}," = "),(0,s._)("span",{style:{color:"#CE9178"}},"`"),(0,s._)("span",{style:{color:"#569CD6"}},"${"),(0,s._)("span",{style:{color:"#9CDCFE"}},"url"),(0,s._)("span",{style:{color:"#569CD6"}},"}${"),(0,s._)("span",{style:{color:"#9CDCFE"}},"url"),(0,s._)("span",{style:{color:"#D4D4D4"}},"."),(0,s._)("span",{style:{color:"#DCDCAA"}},"includes"),(0,s._)("span",{style:{color:"#D4D4D4"}},"("),(0,s._)("span",{style:{color:"#CE9178"}},"'?'"),(0,s._)("span",{style:{color:"#D4D4D4"}},") ? "),(0,s._)("span",{style:{color:"#CE9178"}},"'&'"),(0,s._)("span",{style:{color:"#D4D4D4"}}," : "),(0,s._)("span",{style:{color:"#CE9178"}},"'?'"),(0,s._)("span",{style:{color:"#569CD6"}},"}${"),(0,s._)("span",{style:{color:"#DCDCAA"}},"normalizeParams"),(0,s._)("span",{style:{color:"#D4D4D4"}},"(")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"      "),(0,s._)("span",{style:{color:"#9CDCFE"}},"params")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"    )"),(0,s._)("span",{style:{color:"#569CD6"}},"}"),(0,s._)("span",{style:{color:"#CE9178"}},"`")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"    "),(0,s._)("span",{style:{color:"#9CDCFE"}},"document"),(0,s._)("span",{style:{color:"#D4D4D4"}},"."),(0,s._)("span",{style:{color:"#9CDCFE"}},"body"),(0,s._)("span",{style:{color:"#D4D4D4"}},"."),(0,s._)("span",{style:{color:"#DCDCAA"}},"appendChild"),(0,s._)("span",{style:{color:"#D4D4D4"}},"("),(0,s._)("span",{style:{color:"#9CDCFE"}},"scriptEle"),(0,s._)("span",{style:{color:"#D4D4D4"}},")")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"  })")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"}")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"}),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#DCDCAA"}},"jsonp"),(0,s._)("span",{style:{color:"#D4D4D4"}},"("),(0,s._)("span",{style:{color:"#CE9178"}},"'https://www.baidu.com/sugrec'"),(0,s._)("span",{style:{color:"#D4D4D4"}},", {")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"  "),(0,s._)("span",{style:{color:"#9CDCFE"}},"prod:"),(0,s._)("span",{style:{color:"#D4D4D4"}}," "),(0,s._)("span",{style:{color:"#CE9178"}},"'pc'"),(0,s._)("span",{style:{color:"#D4D4D4"}},",")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"  "),(0,s._)("span",{style:{color:"#9CDCFE"}},"wd:"),(0,s._)("span",{style:{color:"#D4D4D4"}}," "),(0,s._)("span",{style:{color:"#CE9178"}},"'跨域'")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"})."),(0,s._)("span",{style:{color:"#DCDCAA"}},"then"),(0,s._)("span",{style:{color:"#D4D4D4"}},"(("),(0,s._)("span",{style:{color:"#9CDCFE"}},"res"),(0,s._)("span",{style:{color:"#D4D4D4"}},") "),(0,s._)("span",{style:{color:"#569CD6"}},"=>"),(0,s._)("span",{style:{color:"#D4D4D4"}}," {")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"  "),(0,s._)("span",{style:{color:"#9CDCFE"}},"console"),(0,s._)("span",{style:{color:"#D4D4D4"}},"."),(0,s._)("span",{style:{color:"#DCDCAA"}},"log"),(0,s._)("span",{style:{color:"#D4D4D4"}},"("),(0,s._)("span",{style:{color:"#9CDCFE"}},"res"),(0,s._)("span",{style:{color:"#D4D4D4"}},")")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"},[(0,s._)("span",{style:{color:"#D4D4D4"}},"})")]),(0,s.Uk)("\n"),(0,s._)("span",{class:"line"})])]),(0,s._)("div",{class:"line-numbers"},[(0,s._)("span",{class:"line-number"},"1"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"2"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"3"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"4"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"5"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"6"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"7"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"8"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"9"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"10"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"11"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"12"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"13"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"14"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"15"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"16"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"17"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"18"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"19"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"20"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"21"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"22"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"23"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"24"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"25"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"26"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"27"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"28"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"29"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"30"),(0,s._)("br"),(0,s._)("span",{class:"line-number"},"31"),(0,s._)("br")])])],-1),K=(0,s._)("div",{class:"custom-container tip"},[(0,s._)("p",{class:"custom-container-title"},"JSONP 跨域优缺点"),(0,s._)("ul",null,[(0,s._)("li",null,"优点: 实现简单，兼容性好"),(0,s._)("li",null,[(0,s.Uk)("缺点 "),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Uk)("只支持 "),(0,s._)("code",null,"GET"),(0,s.Uk)(" 请求")]),(0,s._)("li",null,[(0,s.Uk)("容易遭受 "),(0,s._)("code",null,"XSS"),(0,s.Uk)(" 攻击")])])])])],-1),Z={href:"https://juejin.cn/post/6844904126246027278",target:"_blank",rel:"noopener noreferrer"},Y=(0,s.Uk)("了解更多跨域解决方案请点击 —— 10 种跨域解决方案"),Q=(0,s._)("h2",{id:"浏览器缓存机制",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#浏览器缓存机制","aria-hidden":"true"},"#"),(0,s.Uk)(" 浏览器缓存机制")],-1),V=(0,s._)("ul",null,[(0,s._)("li",null,[(0,s._)("ol",null,[(0,s._)("li",null,"浏览器在发送请求前先判断是否命中强缓存")]),(0,s._)("ul",null,[(0,s._)("li",null,"命中则不发送请求直接使用缓存，否则进行下一步")])]),(0,s._)("li",null,[(0,s._)("ol",{start:"2"},[(0,s._)("li",null,"浏览器发送请求后会由服务器判断是否命中协商缓存")]),(0,s._)("ul",null,[(0,s._)("li",null,"命中则从缓存获取资源，否则进行下一步")])]),(0,s._)("li",null,[(0,s._)("ol",{start:"3"},[(0,s._)("li",null,"浏览器直接使用服务器返回的资源并更新缓存")])])],-1),ll=(0,s._)("h3",{id:"强缓存-200-ok",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#强缓存-200-ok","aria-hidden":"true"},"#"),(0,s.Uk)(" 强缓存（200 OK）")],-1),nl=(0,s._)("ul",null,[(0,s._)("li",null,[(0,s._)("code",null,"Expires"),(0,s.Uk)(" 是服务器告诉浏览器的缓存过期时间（值为 "),(0,s._)("code",null,"GMT"),(0,s.Uk)(" 时间，即格林尼治时间） "),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s._)("code",null,"HTTP1.0"),(0,s.Uk)(" 的产物")]),(0,s._)("li",null,"受本地时间影响"),(0,s._)("li",null,[(0,s.Uk)("设置的值为 "),(0,s._)("code",null,"max-age=xxx"),(0,s.Uk)("（xxx 是 秒）")])])]),(0,s._)("li",null,[(0,s._)("code",null,"Cache-Control"),(0,s.Uk)(" 用于控制缓存的行为 "),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Uk)("是 "),(0,s._)("code",null,"HTTP1.1"),(0,s.Uk)(" 的产物")]),(0,s._)("li",null,[(0,s.Uk)("取值 "),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s._)("code",null,"public"),(0,s.Uk)("：允许被客户端和代理服务器缓存")]),(0,s._)("li",null,[(0,s._)("code",null,"private"),(0,s.Uk)("：只允许被客户端缓存（默认值）")]),(0,s._)("li",null,[(0,s._)("code",null,"no-cache"),(0,s.Uk)("：允许被客户端和代理服务器缓存，但在使用缓存时需要经过协商缓存来验证决定")]),(0,s._)("li",null,[(0,s._)("code",null,"no-store"),(0,s.Uk)("：所有内容都不会被缓存，即不使用强制缓存也不使用协商缓存每次请求都会下载完整的资源")]),(0,s._)("li",null,[(0,s._)("code",null,"maxage=xxx"),(0,s.Uk)("：设置客户端和代理服务器的缓存时间，表示缓存内容将在 xxx 秒后失效")]),(0,s._)("li",null,[(0,s._)("code",null,"s-maxage=xxx"),(0,s.Uk)("：设置代理服务器的缓存时间（优先级比 "),(0,s._)("code",null,"max-age"),(0,s.Uk)(" 高）")])])])])])],-1),el=(0,s._)("div",{class:"custom-container warning"},[(0,s._)("p",{class:"custom-container-title"},"Cache-Control 注意点"),(0,s._)("p",null,[(0,s._)("code",null,"no-cache"),(0,s.Uk)(" 名字存在误导，其并不是不缓存数据，只是在使用缓存时需要经过协商缓存来验证决定"),(0,s._)("br"),(0,s._)("code",null,"max-age=0"),(0,s.Uk)(" 和 "),(0,s._)("code",null,"no-cache"),(0,s.Uk)(" 效果一致")])],-1),sl=(0,s._)("h4",{id:"缓存位置",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#缓存位置","aria-hidden":"true"},"#"),(0,s.Uk)(" 缓存位置")],-1),ol=(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Uk)("内存缓存（memory cache） "),(0,s._)("ul",null,[(0,s._)("li",null,"快速读取（内存缓存将编译解析后的文件，直接存入该进程的内存中，占据该进程一定的内存资源，以方便下次运行使用时的快速读取）"),(0,s._)("li",null,"进程关闭时数据会被清除"),(0,s._)("li",null,[(0,s.Uk)("不请求网络资源，资源存在内存中一般 "),(0,s._)("code",null,"JS"),(0,s.Uk)(" 和图片文件会存入内存")]),(0,s._)("li",null,[(0,s.Uk)("状态码："),(0,s._)("code",null,"200（from memory cache）")])])]),(0,s._)("li",null,[(0,s.Uk)("硬盘缓存（disk cache） "),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Uk)("写入硬盘文件进行 "),(0,s._)("code",null,"I/O"),(0,s.Uk)(" 操作")]),(0,s._)("li",null,"进程关闭时数据不会被清除"),(0,s._)("li",null,[(0,s.Uk)("速度比 "),(0,s._)("code",null,"memory cache"),(0,s.Uk)(" 慢")]),(0,s._)("li",null,[(0,s.Uk)("不请求网络资源，资源存在磁盘中一般非脚本会存在磁盘中，如 "),(0,s._)("code",null,"css")]),(0,s._)("li",null,[(0,s.Uk)("状态码："),(0,s._)("code",null,"200（from disk cache）")])])]),(0,s._)("li",null,[(0,s.Uk)("代理服务器缓存（server worker） "),(0,s._)("ul",null,[(0,s._)("li",null,"可以拦截处理页面的所有网络请求"),(0,s._)("li",null,[(0,s.Uk)("仅 "),(0,s._)("code",null,"HTTPS"),(0,s.Uk)(" 下可用、存在兼容问题")]),(0,s._)("li",null,[(0,s.Uk)("状态码："),(0,s._)("code",null,"200（from service worker）")])])])],-1),_l=(0,s._)("h3",{id:"协商缓存-304-not-modified",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#协商缓存-304-not-modified","aria-hidden":"true"},"#"),(0,s.Uk)(" 协商缓存（304 Not Modified）")],-1),al=(0,s._)("h4",{id:"last-modified-和-if-modified-since",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#last-modified-和-if-modified-since","aria-hidden":"true"},"#"),(0,s.Uk)(),(0,s._)("code",null,"Last-Modified"),(0,s.Uk)(" 和 "),(0,s._)("code",null,"If-Modified-Since")],-1),cl=(0,s._)("p",null,[(0,s._)("code",null,"Last-Modified"),(0,s.Uk)(" 表示资源的最后修改时间，值为 "),(0,s._)("code",null,"GMT"),(0,s.Uk)(" 格式时间字符串，精确到秒")],-1),rl=(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Uk)("浏览器第一次请求时，服务器会在响应头中返回请求资源的上次更新时间 "),(0,s._)("code",null,"Last-Modified")]),(0,s._)("li",null,[(0,s.Uk)("当浏览器再次请求时，会在请求头中携带 "),(0,s._)("code",null,"If-Modified-Since"),(0,s.Uk)(" 值为上次请求返回的 "),(0,s._)("code",null,"Last-Modified")]),(0,s._)("li",null,[(0,s.Uk)("服务器收到请求后，会根据请求头中的 "),(0,s._)("code",null,"If-Modified-Since"),(0,s.Uk)(" 和该资源在服务器的最后被修改时间做对比 "),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Uk)("大于 "),(0,s._)("code",null,"If-Modified-Since"),(0,s.Uk)(" 重新返回资源文件，状态码为 200")]),(0,s._)("li",null,[(0,s.Uk)("小于 "),(0,s._)("code",null,"If-Modified-Since"),(0,s.Uk)(" 资源无更新继续使用缓存文件，状态码为 304")])])])],-1),tl=(0,s._)("div",{class:"custom-container tip"},[(0,s._)("p",{class:"custom-container-title"},"Last-Modified 存在的问题"),(0,s._)("ul",null,[(0,s._)("li",null,"时间精度为秒级会出现误差情况，对文件修改精度有严格要求的场景不能满足"),(0,s._)("li",null,"在集群服务器上各个服务器上的文件时间可能不同"),(0,s._)("li",null,"如果用旧文件覆盖新文件，因为时间更前浏览器不会请求旧文件"),(0,s._)("li",null,"编辑了文件但未修改，会导致缓存失效")])],-1),ul=(0,s._)("h4",{id:"etag-和-if-none-match",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#etag-和-if-none-match","aria-hidden":"true"},"#"),(0,s.Uk)(" ETag 和 If-None-Match")],-1),il=(0,s._)("p",null,[(0,s._)("code",null,"ETag"),(0,s.Uk)(" 是服务器通过算法对资源内容计算出的一个唯一标识（文件 "),(0,s._)("code",null,"hash"),(0,s.Uk)("）其有强弱之分")],-1),Dl=(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Uk)("强 "),(0,s._)("code",null,"Etag"),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s._)("code",null,'ETag: "<etag_value>"')]),(0,s._)("li",null,"资源发生任何改变都会立刻更新"),(0,s._)("li",null,"难生成，利于比较")])]),(0,s._)("li",null,[(0,s.Uk)("弱 "),(0,s._)("code",null,"Etag"),(0,s.Uk)("（使用 "),(0,s._)("code",null,"W/"),(0,s.Uk)(" 标识） "),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s._)("code",null,'ETag: W/"<etag_value>"')]),(0,s._)("li",null,"只在资源发生本质变化时更新"),(0,s._)("li",null,"易生成，不利于比较")])])],-1),pl=(0,s._)("h5",{id:"过程",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#过程","aria-hidden":"true"},"#"),(0,s.Uk)(" 过程")],-1),dl=(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Uk)("浏览器第一次请求时，服务器会在响应头中返回当前资源文件的一个唯一标识 "),(0,s._)("code",null,"ETag")]),(0,s._)("li",null,[(0,s.Uk)("当浏览器再次请求时，会在请求头中携带 "),(0,s._)("code",null,"If-None-Match"),(0,s.Uk)(" 值为上次请求返回的 "),(0,s._)("code",null,"ETag")]),(0,s._)("li",null,[(0,s.Uk)("通过接收的 "),(0,s._)("code",null,"ETag"),(0,s.Uk)(" 和服务器重新生成的 "),(0,s._)("code",null,"ETag"),(0,s.Uk)(" 进行对比 "),(0,s._)("ul",null,[(0,s._)("li",null,"不一致 重新返回资源文件，状态码为 200"),(0,s._)("li",null,"一致 资源无更新继续使用缓存文件，状态码为 304")])])],-1),kl=(0,s._)("div",{class:"custom-container tip"},[(0,s._)("p",{class:"custom-container-title"},"Last-Modified 和 Etag 对比"),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Uk)("精确度上："),(0,s._)("code",null,"Etag"),(0,s.Uk)(" 优于 "),(0,s._)("code",null,"Last-Modified")]),(0,s._)("li",null,[(0,s.Uk)("性能上："),(0,s._)("code",null,"Etag < Last-Modified"),(0,s.Uk)(" 每次生成 "),(0,s._)("code",null,"ETag"),(0,s.Uk)(" 都需要进行读写操作，而 "),(0,s._)("code",null,"Last-Modified"),(0,s.Uk)(" 只需要读取操作")]),(0,s._)("li",null,[(0,s.Uk)("优先级：服务器校验优先考虑 "),(0,s._)("code",null,"Etag")])])],-1),Ul=(0,s._)("h3",{id:"应用场景",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#应用场景","aria-hidden":"true"},"#"),(0,s.Uk)(" 应用场景")],-1),yl=(0,s._)("table",null,[(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"强缓存"),(0,s._)("th",null,"协商缓存")])]),(0,s._)("tbody",null,[(0,s._)("tr",null,[(0,s._)("td",null,[(0,s.Uk)("不常变化的文件"),(0,s._)("br"),(0,s.Uk)("带 hash 值的 css js 图片")]),(0,s._)("td",null,[(0,s.Uk)("频繁变动的文件"),(0,s._)("br"),(0,s.Uk)("html 文件")])])])],-1),Cl=(0,s._)("h3",{id:"用户行为对缓存的影响",tabindex:"-1"},[(0,s._)("a",{class:"header-anchor",href:"#用户行为对缓存的影响","aria-hidden":"true"},"#"),(0,s.Uk)(" 用户行为对缓存的影响")],-1),hl=(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Uk)("地址栏输入 "),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Uk)("查找 "),(0,s._)("code",null,"disk cache"),(0,s.Uk)("（磁盘缓存）中是否有匹配，有则使用缓存，没有则发送网络请求")])])]),(0,s._)("li",null,[(0,s.Uk)("普通刷新（F5） "),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Uk)("因为浏览器 "),(0,s._)("code",null,"tab"),(0,s.Uk)(" 标签并没有关闭，因此 "),(0,s._)("code",null,"memory cache"),(0,s.Uk)(" （内存缓存）是可用的，会被优先使用，其次使用 "),(0,s._)("code",null,"disk cache"),(0,s.Uk)("（磁盘缓存）")]),(0,s._)("li",null,"跳过强缓存规则，直接走协商缓存")])]),(0,s._)("li",null,[(0,s.Uk)("强制刷新（Ctrl + F5） "),(0,s._)("ul",null,[(0,s._)("li",null,[(0,s.Uk)("浏览器不使用缓存，因此发送的请求头部均带有 "),(0,s._)("code",null,"Cache-control: no-cache"),(0,s.Uk)(" （为了兼容还带了 "),(0,s._)("code",null,"Pragma: no-cache"),(0,s.Uk)("）服务器直接返回 200 和最新内容。")]),(0,s._)("li",null,"跳过所有缓存规则")])])],-1),ml={},bl=(0,e(3744).Z)(ml,[["render",function(l,n){const e=(0,s.up)("OutboundLink");return(0,s.wg)(),(0,s.iD)(s.HY,null,[_,a,(0,s._)("div",c,[r,(0,s._)("p",null,[(0,s._)("a",t,[u,(0,s.Wm)(e)]),i,D,p]),d]),k,U,y,C,(0,s._)("p",null,[(0,s._)("a",h,[m,(0,s.Wm)(e)]),b,(0,s._)("a",g,[E,(0,s.Wm)(e)]),f,A,x,O,S]),v,F,T,w,M,R,P,L,H,N,j,J,I,(0,s._)("p",null,[(0,s._)("a",W,[q,(0,s.Wm)(e)])]),z,X,$,G,B,K,(0,s._)("p",null,[(0,s._)("a",Z,[Y,(0,s.Wm)(e)])]),Q,V,ll,nl,el,sl,ol,_l,al,cl,rl,tl,ul,il,Dl,pl,dl,kl,Ul,yl,Cl,hl],64)}]])},3744:(l,n)=>{n.Z=(l,n)=>{const e=l.__vccOpts||l;for(const[l,s]of n)e[l]=s;return e}},809:(l,n,e)=>{l.exports=e.p+"assets/img/cors-process.48608d9b.png"}}]);